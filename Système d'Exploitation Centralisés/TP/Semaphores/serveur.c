#include <sys/ipc.h>
#include <sys/shm.h>
#include "../my_lib/sem.h"

int main() {
    new(calcul, "/bin", 0600);
    new(res, "/bin", 0600);
    new(donnees, "/bin", 0600);
    new(mutex_acces, "/bin", 0600);
    init(calcul, 1, 0);
    init(res, 1, 0);
    init(donnees, 1, 0);
    init(mutex_acces, 1, 1);

    int r;
    for(;;) {
        P(donnees, 1);
        r = semget(kres, 1, 0600);
        r*=r;
        V(res,1);
    }

    del(res);
    del(donnees);
    del(mutex_acces);
    
    return 0;
}