#include <sys/ipc.h>
#include <sys/shm.h>
#include "../my_lib/sem.h"

int main() {
    new(calcul, "/bin", 0600);
    new(res, "/bin", 0600);
    new(donnees, "/bin", 0600);
    new(mutex_acces, "/bin", 0600);

    int shmid, *shared_int;
    if((shmid = shmget("kres", sizeof(int), 0600)) == ERR) perror("shmget"), exit(1);
    if((shared_int = (int*) shmat(shmid,0,0)) == NULL) perror("Attach"), exit(3);
    P(mutex_acces, 1);
    write_shm(d);
    V(donnees,1);
    P(res,1);
    d = read_shm();
    V(mutex_acces, 0);
    return 0;
}