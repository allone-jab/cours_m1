#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX 64
#define ALLOC_FAILURE 1

char* readLine() {
    int position = 0;
    int buffer_size = MAX;
    char* buffer = malloc(sizeof(char) * buffer_size);
    char c;

    if(!buffer) {
        fprintf(stderr, "Allocation error\n");
        exit(ALLOC_FAILURE);
    }

    for(;;) {
        c = getchar();

        if(c == EOF || c == '\n') {
            buffer[position]= '\0';
            return buffer;
        }
        buffer[position++] = c;

        if(position >= MAX) {
            buffer_size += buffer_size;
            buffer = realloc(buffer, buffer_size);
            if(!buffer) {
                fprintf(stderr, "Allocation error\n");
                exit(ALLOC_FAILURE);
            }
        }
    }
    free(buffer);
}

void prompt(){
    char buffer[100];
    printf("%s >", getcwd(buffer, 100));
    char* command = readLine();
    if(!strcmp(command, "exit")){
        exit(0);
    }
    system(command);
}

int main() {
    for(;;) {    
        prompt();
    }
}