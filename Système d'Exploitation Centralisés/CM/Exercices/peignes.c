#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>

#define ERR -1

typedef int pid_t;

void peigne_droit(int n) {
    pid_t pid;
    int i;

    for(i = 0; i < n; i++) {
        pid = fork();
        if(pid == ERR) perror("Fork"), exit(2);
        if(pid) return;
    }
}

void peigne_gauche(int n) {
    pid_t pid;
    int i;

    for(i = 0; i < n; i++) {
        pid = fork();
        if(pid == ERR) perror("Fork"), exit(2);
        if(!pid) return;
    }
}

int main(int argc, char* argv[]){
    int n;
    if(argc != 2) {
        fprintf(stderr, "One argument needed.");
        exit(1);
    }

    n = atoi(*(argv+1));
    if(n > 1) peigne_droit(n);
    printf("Processus id: %d\n", getpid());
    exit(0);
}