/* Philosopher's problem */
#define N

typedef Etat enum etat{PENSE, MANGE, AFAIM};
typedef int sem;

// SEMAPHORES
sem tab[N] = {};
Etat tab_etat[N] = {PENSE, PENSE, MANGE};
sem mutex = 1;


//PHILOSOPHER
void philo() {
    int i; // Place du philo
    penser();

    take_chopsticks(i);
    manger();
    lay_chopsticks(i);
}

void take_chopsticks(int i) {
    P(mutex);
    tab_etat[i] = AFAIM;
    if((tab_etat[G(i)] != MANGE) &&(tab_etat[D(i)] != MANGE))
        V(tab[i]);
    V(mutex);
    P(tab[i])
}

void lay_chopsticks(int i) {
    P(mutex);
    tab_etat[i] = PENSE;
    if((tab_etat[G(i)] ==  AFAIM) && (tab_etat[G(G(i))] != MANGE)){
        V(tab[G(i)]);
        tab_etat[G(i)] = MANGE;
    }
    if((tab_etat[D(i)] ==  AFAIM) && (tab_etat[D(D(i))] != MANGE)){
        V(tab[D(i)]);
        tab_etat[D(i)] = MANGE;
    }
    V(mutex);
}